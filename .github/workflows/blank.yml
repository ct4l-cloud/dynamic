name: XL Redeem Ultra Fast â€“ SETIAP 10 MENIT (WIB)

on:
#  schedule:
    # Setiap 10 menit tepat (00:00, 00:10, 00:20, 00:30, 00:40, 00:50 WIB dst.)
#    - cron: '0,10,20,30,40,50 * * * *'   # Cara paling jelas & akurat

    # Alternatif lain yang sama hasilnya:
    # - cron: '*/10 * * * *'

  workflow_dispatch:  # Tetap bisa dijalankan manual

jobs:
  redeem:
    runs-on: ubuntu-latest
    env:
      TZ: Asia/Jakarta                     # Log langsung jadi WIB

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'

      - name: Install requests
        run: pip install requests --quiet

      - name: Jalankan Redeem Bot (Setiap 10 menit)
        env:
          BASE_URL: ${{ secrets.BASE_URL }}
          REFRESH_TOKEN: ${{ secrets.REFRESH_TOKEN }}
          FAMILY_CODE: ${{ secrets.FAMILY_CODE }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_USER_ID: ${{ secrets.TELEGRAM_USER_ID }}
        run: python redeem.py

      - name: Cleanup
        if: always()
        run: rm -rf /home/runner/.cache/pip || true
